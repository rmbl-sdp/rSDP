<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="The rSDP package provides a simplified interface for discovering, querying, and subsetting data products that are incorporated into the RMBL Spatial Data Platform. The RMBL SDP provides a set of curated, high-resolution, and high-fidelity geospatial datasets for a set of domains in Western Colorado (USA) in the vicinity of [Rocky Mountain Biological Laboratory](https://rmbl.org). For more information about the RMBL SDP [see here](https://www.rmbl.org/scientists/resources/spatial-data-platform/). SDP data products are provided as geospatial raster datasets in [cloud-optimized Geotiff]() (COG) format. The rSDP package provides functions to access these datasets in cloud storage (Amazon S3) without downloading.">
<title>Discover, Query, and Subset Data from the RMBL Spatial Data Platform • rSDP</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Discover, Query, and Subset Data from the RMBL Spatial Data Platform">
<meta property="og:description" content="The rSDP package provides a simplified interface for discovering, querying, and subsetting data products that are incorporated into the RMBL Spatial Data Platform. The RMBL SDP provides a set of curated, high-resolution, and high-fidelity geospatial datasets for a set of domains in Western Colorado (USA) in the vicinity of [Rocky Mountain Biological Laboratory](https://rmbl.org). For more information about the RMBL SDP [see here](https://www.rmbl.org/scientists/resources/spatial-data-platform/). SDP data products are provided as geospatial raster datasets in [cloud-optimized Geotiff]() (COG) format. The rSDP package provides functions to access these datasets in cloud storage (Amazon S3) without downloading.">
<meta property="og:image" content="https://rmbl-sdp.github.io/rSDP/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">rSDP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-resources">Resources</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-resources">
    <h6 class="dropdown-header" data-toc-skip>Tutorials</h6>
    <a class="dropdown-item" href="articles/sdp-cloud-data.html">Connecting to Datasets</a>
    <a class="dropdown-item" href="articles/field-site-sampling.html">Extracting data for Field Sites</a>
    <a class="dropdown-item" href="articles/wrangle-raster-data.html">Wrangling Spatial Datasets</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>SDP Dataset Catalog</h6>
    <a class="external-link dropdown-item" href="https://www.rmbl.org/scientists/resources/data-catalog/?tag-id=84">All SDP Datasets</a>
    <a class="external-link dropdown-item" href="https://www.rmbl.org/scientists/resources/data-catalog/?tag-id=84">Release One</a>
    <a class="external-link dropdown-item" href="https://www.rmbl.org/scientists/resources/data-catalog/?tag-id=84">Release Two</a>
    <a class="external-link dropdown-item" href="https://www.rmbl.org/scientists/resources/data-catalog/?tag-id=84">Release Three</a>
    <a class="external-link dropdown-item" href="https://www.rmbl.org/scientists/resources/data-catalog/?tag-id=84">Release Four</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rmbl-sdp/rSDP/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.svg" class="logo" alt=""><h1 id="rsdp-">rSDP <a class="anchor" aria-label="anchor" href="#rsdp-"></a>
</h1>
</div>
<!-- badges: start -->
<!-- badges: end -->
<p>The rSDP package provides a simple interface for discovering, querying, and subsetting data products that are incorporated into the RMBL Spatial Data Platform. The RMBL SDP provides a set of curated, high-resolution, and high-fidelity geospatial datasets for a set of domains in Western Colorado (USA) in the vicinity of <a href="https://rmbl.org" class="external-link">Rocky Mountain Biological Laboratory</a>. For more information about the RMBL SDP <a href="https://www.rmbl.org/scientists/resources/spatial-data-platform/" class="external-link">see here</a>.</p>
<p>SDP data products are provided as geospatial raster datasets in <a href="">cloud-optimized Geotiff</a> (COG) format. The rSDP package provides functions to access these datasets in cloud storage (Amazon S3) without downloading.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the latest version of rSDP from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"rmbl-sdp/rSDP"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="discovering-sdp-data-and-metadata">Discovering SDP Data and Metadata<a class="anchor" aria-label="anchor" href="#discovering-sdp-data-and-metadata"></a>
</h2>
<p>The package provides functions <code><a href="reference/sdp_get_catalog.html">sdp_get_catalog()</a></code>, and <code><a href="reference/sdp_get_metadata.html">sdp_get_metadata()</a></code> that download information about what datasets are currently available and what their spatial attributes are.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rmbl-sdp/rSDP" class="external-link">rSDP</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Gets entries for vegetation data products in the Upper Gunnison (UG) domain.</span></span>
<span><span class="va">sdp_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sdp_get_catalog.html">sdp_get_catalog</a></span><span class="op">(</span>domains<span class="op">=</span><span class="st">"UG"</span>, </span>
<span>                           types<span class="op">=</span><span class="st">"Vegetation"</span>,</span>
<span>                           deprecated<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                           return_stac<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">sdp_cat</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt;    CatalogID  Release       Type                       Product Domain</span></span>
<span><span class="co">#&gt; 54    R3D013 Release3 Vegetation              Understory Cover     UG</span></span>
<span><span class="co">#&gt; 55    R3D014 Release3 Vegetation       Vegetation Canopy Cover     UG</span></span>
<span><span class="co">#&gt; 56    R3D015 Release3 Vegetation      Vegetation Canopy Height     UG</span></span>
<span><span class="co">#&gt; 57    R3D016 Release3 Vegetation 20th Percentile Canopy Height     UG</span></span>
<span><span class="co">#&gt; 58    R3D017 Release3 Vegetation 80th Percentile Canopy Height     UG</span></span>
<span><span class="co">#&gt; 59    R3D018 Release3 Vegetation               Basic Landcover     UG</span></span>
<span><span class="co">#&gt; 60    R3D019 Release3 Vegetation        October 2017 NAIP NDVI     UG</span></span>
<span><span class="co">#&gt; 61    R3D020 Release3 Vegetation       Septober 2019 NAIP NDVI     UG</span></span>
<span><span class="co">#&gt; 73     BM012 Basemaps Vegetation      Canopy Structure Basemap     UG</span></span>
<span><span class="co">#&gt; 74     BM013 Basemaps Vegetation             Landcover Basemap     UG</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Grabs detailed metadata for a specific dataset.</span></span>
<span><span class="va">item_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sdp_get_metadata.html">sdp_get_metadata</a></span><span class="op">(</span>catalog_id<span class="op">=</span><span class="st">"R1D001"</span>,return_list<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Prints the detailed description.</span></span>
<span><span class="va">item_description</span> <span class="op">&lt;-</span> <span class="va">item_meta</span><span class="op">$</span><span class="va">qgis</span><span class="op">$</span><span class="va">abstract</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">item_description</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "This map represents estimated stream flowlines from a hydrologically corrected digital elevation model. The lines were derived in GRASS GIS using a multi-direction algorithm that allows channel braiding. Each stream segment is identified by a unique integer. Stream lines were delineated for drainage areas greater than 512000 square meters.\n"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="accessing-sdp-data-in-the-cloud">Accessing SDP data in the cloud.<a class="anchor" aria-label="anchor" href="#accessing-sdp-data-in-the-cloud"></a>
</h2>
<p>The function <code><a href="reference/sdp_get_raster.html">sdp_get_raster()</a></code>, creates R representations of cloud-based datasets that can be used for further processing, returning a <code>SpatRaster</code> which can be further manipulated using functions in the <code>terra</code> package.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Creates a `SpatRaster` object for a dataset.</span></span>
<span><span class="va">dem</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sdp_get_raster.html">sdp_get_raster</a></span><span class="op">(</span>catalog_id<span class="op">=</span><span class="st">"R3D009"</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dem</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example3-1.png" width="100%"> Alternatively, you can plot these data on a web map:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plet.html" class="external-link">plet</a></span><span class="op">(</span><span class="va">dem</span>,tiles<span class="op">=</span><span class="st">"Esri.WorldImagery"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="extracting-samples-of-sdp-data">Extracting samples of SDP data.<a class="anchor" aria-label="anchor" href="#extracting-samples-of-sdp-data"></a>
</h2>
<p>The function <code><a href="reference/sdp_extract_data.html">sdp_extract_data()</a></code> extracts samples from datasets at locations represented by points, lines, or polygons.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extracts values of an SDP dataset.</span></span>
<span><span class="va">elev</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sdp_get_raster.html">sdp_get_raster</a></span><span class="op">(</span>catalog_id<span class="op">=</span><span class="st">"R3D009"</span><span class="op">)</span></span>
<span><span class="va">slope</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sdp_get_raster.html">sdp_get_raster</a></span><span class="op">(</span>catalog_id<span class="op">=</span><span class="st">"R3D012"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">location_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>SiteName<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Roaring Judy"</span>,<span class="st">"Gothic"</span>,<span class="st">"Galena Lake"</span><span class="op">)</span>,</span>
<span>                          Lat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">38.716995</span>,<span class="fl">38.958446</span>,<span class="fl">39.021644</span><span class="op">)</span>,</span>
<span>                          Lon<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">106.853186</span>,<span class="op">-</span><span class="fl">106.988934</span>,<span class="op">-</span><span class="fl">107.072569</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">location_sv</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="va">location_df</span>,geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Lon"</span>,<span class="st">"Lat"</span><span class="op">)</span>,crs<span class="op">=</span><span class="st">"EPSG:4327"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dem_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sdp_extract_data.html">sdp_extract_data</a></span><span class="op">(</span>raster<span class="op">=</span><span class="va">elev</span>,locations<span class="op">=</span><span class="va">location_sv</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Re-projecting locations to coordinate system of the raster."</span></span>
<span><span class="co">#&gt; [1] "Extracting data at 3 locations for 1 raster layers."</span></span>
<span><span class="co">#&gt; [1] "Extraction complete."</span></span>
<span><span class="va">slope_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sdp_extract_data.html">sdp_extract_data</a></span><span class="op">(</span>raster<span class="op">=</span><span class="va">slope</span>,locations<span class="op">=</span><span class="va">dem_sample</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Extracting data at 3 locations for 1 raster layers."</span></span>
<span><span class="co">#&gt; [1] "Extraction complete."</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">slope_sample</span><span class="op">$</span><span class="va">UG_dem_3m_v1</span>,<span class="va">slope_sample</span><span class="op">$</span><span class="va">UG_dem_slope_1m_v1</span>,xlab<span class="op">=</span><span class="st">"Elevation (m)."</span>,</span>
<span>     ylab<span class="op">=</span><span class="st">"Slope (degrees)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example4-1.png" width="100%"></p>
<p>With line or polygon locations <code><a href="reference/sdp_extract_data.html">sdp_extract_data()</a></code> summarizes raster values by line or polygon. The default method computes the mean value for each polygon, but you can also specify other summary functions using the <code>sum_fun</code> argument.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slope</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sdp_get_raster.html">sdp_get_raster</a></span><span class="op">(</span>catalog_id<span class="op">=</span><span class="st">"R3D012"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">location_poly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>SiteName<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Wet"</span>,<span class="st">"Conifer"</span>,<span class="st">"Rocky"</span><span class="op">)</span>,</span>
<span>                            WKT<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POLYGON ((327651 4313638,327620 4313727,327693 4313759, 327651 4313638))"</span>,</span>
<span>                                   <span class="st">"POLYGON ((327340 4314059,327450 4314026,327418 4313970,327340 4314059))"</span>,</span>
<span>                                   <span class="st">"POLYGON ((328193 4314314,328285 4314274,328244 4314223, 328193 4314314))"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">location_poly_sv</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="va">location_poly</span>,geom<span class="op">=</span><span class="st">"WKT"</span>,crs<span class="op">=</span><span class="st">"EPSG:32613"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">slope_site_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sdp_extract_data.html">sdp_extract_data</a></span><span class="op">(</span>raster<span class="op">=</span><span class="va">slope</span>,locations<span class="op">=</span><span class="va">location_poly_sv</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Extracting data at 3 locations for 1 raster layers."</span></span>
<span><span class="co">#&gt; [1] "Extraction complete."</span></span>
<span><span class="va">slope_site_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sdp_extract_data.html">sdp_extract_data</a></span><span class="op">(</span>raster<span class="op">=</span><span class="va">slope</span>,locations<span class="op">=</span><span class="va">slope_site_mean</span>,</span>
<span>                                  sum_fun<span class="op">=</span><span class="va">sd</span>,bind<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Extracting data at 3 locations for 1 raster layers."</span></span>
<span><span class="co">#&gt; [1] "Extraction complete."</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">slope_site_sd</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SiteName"</span>,<span class="st">"ID"</span>,<span class="st">"Slope_mean"</span>,<span class="st">"ID2"</span>,<span class="st">"Slope_sd"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">slope_site_sd</span><span class="op">$</span><span class="va">Slope_mean</span>,<span class="va">slope_site_sd</span><span class="op">$</span><span class="va">Slope_sd</span>,xlab<span class="op">=</span><span class="st">"Slope Mean (deg.)"</span>,</span>
<span>     ylab<span class="op">=</span><span class="st">"Slope Standard Deviation"</span>,pch<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">slope_site_sd</span><span class="op">$</span><span class="va">Slope_mean</span>,<span class="va">slope_site_sd</span><span class="op">$</span><span class="va">Slope_sd</span>,labels<span class="op">=</span><span class="va">slope_site_sd</span><span class="op">$</span><span class="va">SiteName</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example5-1.png" width="100%"> You can also return all the cell values intersecting each line or polygon by specifying <code>sum_fun=NULL</code>. Passing the argument <code>exact=TRUE</code> with polygon features returns the proportion of each raster cell included in the polygon (useful for computing area-weighted means.)</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slope_allcells</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sdp_extract_data.html">sdp_extract_data</a></span><span class="op">(</span>raster<span class="op">=</span><span class="va">slope</span>,locations<span class="op">=</span><span class="va">slope_site_mean</span>,</span>
<span>                                  sum_fun<span class="op">=</span><span class="cn">NULL</span>,exact<span class="op">=</span><span class="cn">TRUE</span>,bind<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Extracting data at 3 locations for 1 raster layers."</span></span>
<span><span class="co">#&gt; [1] "Extraction complete."</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">slope_allcells</span><span class="op">)</span></span>
<span><span class="co">#&gt;   ID UG_dem_slope_1m_v1   fraction</span></span>
<span><span class="co">#&gt; 1  1           4.609455 0.01733949</span></span>
<span><span class="co">#&gt; 2  1           6.018766 0.34246161</span></span>
<span><span class="co">#&gt; 3  1           9.753592 0.60725906</span></span>
<span><span class="co">#&gt; 4  1           3.104769 0.06934668</span></span>
<span><span class="co">#&gt; 5  1           6.362072 0.46575703</span></span>
<span><span class="co">#&gt; 6  1           6.617933 0.88677505</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="working-with-raster-time-series">Working with raster time-series<a class="anchor" aria-label="anchor" href="#working-with-raster-time-series"></a>
</h2>
<p>The <code><a href="reference/sdp_get_raster.html">sdp_get_raster()</a></code> and <code><a href="reference/sdp_extract_data.html">sdp_extract_data()</a></code> functions also provide some convenience features for subsetting time-series datasets by day or year.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Connects to rasters from a temporal subset of daily data.</span></span>
<span><span class="va">tmax</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sdp_get_raster.html">sdp_get_raster</a></span><span class="op">(</span><span class="st">"R4D004"</span>,date_start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2011-12-01"</span><span class="op">)</span>,date_end<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2011-12-30"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Returning dataset with 30 layers, be patient..."</span></span>
<span></span>
<span><span class="co">## Further subsets when extracting data</span></span>
<span><span class="va">tmax_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sdp_extract_data.html">sdp_extract_data</a></span><span class="op">(</span><span class="va">tmax</span>,<span class="va">location_sv</span>,date_start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2011-12-01"</span><span class="op">)</span>,date_end<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2011-12-20"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Re-projecting locations to coordinate system of the raster."</span></span>
<span><span class="co">#&gt; [1] "Extracting data at 3 locations for 20 raster layers."</span></span>
<span><span class="co">#&gt; [1] "Extraction complete."</span></span>
<span><span class="va">tmax_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">tmax_sample</span><span class="op">)</span></span>
<span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tmax_df</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">tmax_sample</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">sites</span> <span class="op">&lt;-</span> <span class="va">tmax_df</span><span class="op">$</span><span class="va">SiteName</span></span>
<span></span>
<span><span class="co">##Plots the result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dates</span>,<span class="va">tmax_df</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">tmax_sample</span><span class="op">)</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"l"</span>,ylab<span class="op">=</span><span class="st">"Tmax (C)"</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">dates</span>,<span class="va">tmax_df</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">tmax_sample</span><span class="op">)</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"l"</span>,col<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">dates</span>,<span class="va">tmax_df</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">tmax_sample</span><span class="op">)</span><span class="op">]</span>,type<span class="op">=</span><span class="st">"l"</span>,col<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, legend<span class="op">=</span><span class="va">sites</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,bty<span class="op">=</span><span class="st">"n"</span>,lty<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example7-1.png" width="100%"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">##Retrieving rasters from a subset of years.</span></span>
<span><span class="va">snow_yearly</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sdp_get_raster.html">sdp_get_raster</a></span><span class="op">(</span><span class="st">"R4D001"</span>,years<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2012</span>,<span class="fl">2019</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Returning dataset with 2 layers be patient..."</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">snow_yearly</span>,range<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">60</span>,<span class="fl">230</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example7-2.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="extracting-data-from-large-time-series-datasets">Extracting data from large time-series datasets.<a class="anchor" aria-label="anchor" href="#extracting-data-from-large-time-series-datasets"></a>
</h2>
<p>For extracting subsets of large datasets, it’s sometimes a good idea to loop over small subsets rather than extracting from a single large raster object with many (sometimes hundreds) of layers.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extracts with a single call.</span></span>
<span><span class="va">start1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">tmax1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sdp_get_raster.html">sdp_get_raster</a></span><span class="op">(</span><span class="st">"R4D004"</span>,date_start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2004-10-01"</span><span class="op">)</span>,date_end<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2004-10-31"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Returning dataset with 31 layers, be patient..."</span></span>
<span></span>
<span><span class="va">tmax_extr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sdp_extract_data.html">sdp_extract_data</a></span><span class="op">(</span><span class="va">tmax1</span>,<span class="va">location_sv</span>,verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">elapsed1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">start1</span></span>
<span></span>
<span><span class="co">## Loops over layers (different subset to avoid cacheing).</span></span>
<span><span class="va">start2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">tmax2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sdp_get_raster.html">sdp_get_raster</a></span><span class="op">(</span><span class="st">"R4D004"</span>,date_start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2005-10-01"</span><span class="op">)</span>,date_end<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2005-10-31"</span><span class="op">)</span>,</span>
<span>                        verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">locations_proj</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">:::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/project.html" class="external-link">project</a></span><span class="op">(</span><span class="va">location_sv</span>,<span class="st">"EPSG:32613"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">extr_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">nlyr</a></span><span class="op">(</span><span class="va">tmax2</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">extr_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sdp_extract_data.html">sdp_extract_data</a></span><span class="op">(</span><span class="va">tmax2</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,<span class="va">locations_proj</span>,verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span></span>
<span>  <span class="va">extr_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">extr_dat</span></span>
<span><span class="op">}</span></span>
<span><span class="va">tmax_extr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">cbind</span>,<span class="va">extr_list</span><span class="op">)</span></span>
<span><span class="va">elapsed2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">start2</span></span>
<span></span>
<span><span class="co">## Loops over creating the raster object itself. </span></span>
<span><span class="co">## This is slower single threaded, but can be more easily made parallel.</span></span>
<span><span class="va">start3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">days</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2006-10-01"</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2006-10-31"</span><span class="op">)</span>,by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span>
<span><span class="va">extr_list3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">days</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">tmax3</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sdp_get_raster.html">sdp_get_raster</a></span><span class="op">(</span><span class="st">"R4D004"</span>,date_start<span class="op">=</span><span class="va">days</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,date_end<span class="op">=</span><span class="va">days</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">extr_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sdp_extract_data.html">sdp_extract_data</a></span><span class="op">(</span><span class="va">tmax3</span>,<span class="va">locations_proj</span>,verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span></span>
<span>  <span class="va">extr_list3</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">extr_dat</span></span>
<span><span class="op">}</span></span>
<span><span class="va">tmax_extr3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">cbind</span>,<span class="va">extr_list3</span><span class="op">)</span></span>
<span><span class="va">elapsed3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">start3</span></span>
<span></span>
<span><span class="co">## Parallel extraction via foreach.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RevolutionAnalytics/foreach" class="external-link">foreach</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'foreach' was built under R version 4.1.2</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RevolutionAnalytics/doparallel" class="external-link">doParallel</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'doParallel' was built under R version 4.1.2</span></span>
<span><span class="co">#&gt; Loading required package: iterators</span></span>
<span><span class="co">#&gt; Warning: package 'iterators' was built under R version 4.1.2</span></span>
<span><span class="co">#&gt; Loading required package: parallel</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'sf' was built under R version 4.1.2</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.10.2, GDAL 3.4.2, PROJ 8.2.1; sf_use_s2() is TRUE</span></span>
<span></span>
<span><span class="co">## Can't pass SpatVector or SpatRaster objects via Foreach, so convert to sf.</span></span>
<span><span class="va">locations_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">location_sv</span><span class="op">)</span></span>
<span></span>
<span><span class="va">start4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu">doParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html" class="external-link">registerDoParallel</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span><span class="va">days</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2007-10-01"</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2007-10-31"</span><span class="op">)</span>,by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">extr_list4</span> <span class="op">&lt;-</span> <span class="fu">foreach</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach</a></span><span class="op">(</span>i<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">days</span><span class="op">)</span>,.packages<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sf"</span>,<span class="st">"terra"</span>,<span class="st">"rSDP"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">%dopar%</a></span> <span class="op">{</span></span>
<span>  <span class="co">#devtools::load_all() ## During package development.</span></span>
<span>  <span class="va">tmax4</span> <span class="op">&lt;-</span> <span class="fu">rSDP</span><span class="fu">::</span><span class="fu"><a href="reference/sdp_get_raster.html">sdp_get_raster</a></span><span class="op">(</span><span class="st">"R4D004"</span>,date_start<span class="op">=</span><span class="va">days</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,date_end<span class="op">=</span><span class="va">days</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span>   <span class="va">extr_dat</span> <span class="op">&lt;-</span> <span class="fu">rSDP</span><span class="fu">::</span><span class="fu"><a href="reference/sdp_extract_data.html">sdp_extract_data</a></span><span class="op">(</span><span class="va">tmax4</span>,<span class="fu">vect</span><span class="op">(</span><span class="va">locations_sf</span><span class="op">)</span>,verbose<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                                      return_spatvector<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span></span>
<span>   <span class="op">(</span><span class="va">extr_dat</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span><span class="va">tmax_extr4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">cbind</span>,<span class="va">extr_list4</span><span class="op">)</span></span>
<span><span class="va">elapsed4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">start4</span></span>
<span></span>
<span><span class="co">##Collects timings.</span></span>
<span><span class="va">timings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>approach<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Single Call"</span>,<span class="st">"Looping sdp_extract_data()"</span>,<span class="st">"Looping over sdp_get_raster()"</span>,<span class="st">"Foreach"</span><span class="op">)</span>,</span>
<span>                      timing<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">elapsed1</span>,<span class="va">elapsed2</span>,<span class="va">elapsed3</span>,<span class="va">elapsed4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">timings</span></span>
<span><span class="co">#&gt;                        approach        timing</span></span>
<span><span class="co">#&gt; 1                   Single Call 22.84320 secs</span></span>
<span><span class="co">#&gt; 2    Looping sdp_extract_data() 36.86560 secs</span></span>
<span><span class="co">#&gt; 3 Looping over sdp_get_raster() 34.61781 secs</span></span>
<span><span class="co">#&gt; 4                       Foreach 27.65680 secs</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/rmbl-sdp/rSDP/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/rmbl-sdp/rSDP/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://creativecommons.org/licenses/by/4.0" class="external-link">CC BY 4.0</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing rSDP</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Ian Breckheimer <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-4698-977X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Ian Breckheimer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
